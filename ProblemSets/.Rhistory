rm(list = ls())
setwd('/Users/jiwanlin/Desktop/MACS30200proj/ProblemSets')
dat <- read.csv('biden.csv')
datAB <- na.omit(dat)
modelA <- lm(biden ~ age + female + educ, data = datAB)
summary(modelA)
library(car)
outlierTest(modelA)
cutoff <- 4/(nrow(datAB) - length(modelA$coefficients) - 2)
plot(modelA, which = 4, cook.levels = cutoff)
abline(h = cutoff, lty = 2, col = "red")
qqPlot(modelA, labels = FALSE, simulate = TRUE, main = "Q-Q Plot")
ncvTest(modelA)
spreadLevelPlot(modelA)
vif(modelA)
sqrt(vif(modelA)) > 2
modelB <- lm(biden ~ age + educ + age:educ, data = datAB)
summary(modelB)
library(mice)
imp <- mice(dat, seed = 1234)
modelC <- with(imp, lm(biden ~ age + female + educ))
pooled <- pool(modelC)
summary(pooled)
imp
datP <- complete(imp, action=3)
head(dat)
